## 表格操作
Python程序虽然能够读入表格、写出表格，但是却并不知道表格中

- 有哪些东西是必须的；
- 有哪些东西是可选的；
- 表格中的东西具有什么涵义。

为了让Python能够理解分析表格，就必须亲自封装便于编程的<b>函数与API</b>，并留下便于<b>用户配置的接口</b>。
基于这一思路，我们来分解表格操作，将所有与表格操作有关的内容放在这个markdown文件中。

首先，我们定义一个Excel表格的形式化组成（第0.部分），然后深入剖析本系统操作各个组成成分的API设计（第1. 2. 部分）。

### 0. Excel表格的组成

#### 0.1 表头：一列数据的标题
先import个pandas

~~~
import pandas as pd
~~~

pandas读取excel的函数pd.read_excel()函数默认每个sheet的第一行是表头！
pd.read_excel()函数返回一个pd.DataFrame对象。

因此，我们规定：每个excel的第一行是表头（标题），即这一列是啥。
如`姓名`，`学号`，像这样的表头就揭示了这一列数据的涵义，是它们的标题。

利用pd.DataFrame对象的.keys()方法可以所有表头。

问题描述：
- <b>Python并不知道表格的表头应该是什么</b>。
如果一个志愿者表没有姓名学号，显然Python并不会报错！！这对于本系统来说将会是一个灾难！
- <b>因此，我们必须手动设计好每个表的表头，且能够交给用户简单配置。</b>

解决策略：
- 在一个配置文件中说明所有表格应该具有的表头内容。
- 构造API，读入该配置文件，在此后的表格处理中，如果表头内容与配置文件不符，则Python报错。
- 这个文件应该修改起来十分容易，可以由不会编程的用户操作（如：excel）。

#### 0.2 数据
pd.DataFrame对象可以用表头（即.keys()里面的东西）来索引每一列。
如：`table["姓名"]` 可以获得整个姓名列。

#### 0.3 行
表中的每一行往往代表同一个实体的各个属性。
如果要根据一个表格内容来创建一系列实体，则要访问每一行。


### 1. 表头
在此具体化问题描述与解决策略：
问题描述：
- Python并不知道表格的表头应该是什么，对错误的表头不会报错。
- 我们必须手动设计好每个表的表头，且能够交给用户简单配置。

解决策略：
- 在配置文件`config\信息说明.xlsx`中，登记所有表格应该具有的表头内容。
- 构造API，读入`config\信息说明.xlsx`，在此后的表格处理中，如果表头内容与配置文件中不符，则Python报错。
- `config\信息说明.xlsx`修改起来十分容易，可以由不会编程的用户操作。

#### 1.1 表头登记（`config\信息说明.xlsx`）

`config\信息说明.xlsx`是表头登记处，每个表的表头需要在此处登记。可修改、编辑。

1. `个人信息`与`其他报名信息`栏目
`config\信息说明.xlsx`中的`个人信息`与`其他报名信息`两列，是创建一个Volunteer类对象时必须的信息。
如果一个表格需要创建一个Volunteer，则必须包含所有`个人信息`与`其他报名信息`中的所有字段。
其中，`个人信息-是否必填`为`是`的，与`其他报名信息`中`其他报名信息-是否必填`为`是`的字段为必填项。（即在表格中是否允许留白。）

2. 其他栏目
`config\信息说明.xlsx`中的其他列，如`面试信息`，`内部人员信息`等表征的是特殊的Volunteer属性。
